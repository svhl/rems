<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>REMS | Add Event</title>
    <link rel="stylesheet" href="stud_dashboard.css">
    <link rel="icon" href="rajagiri.png" type="image/png">
</head>
<body>
    <header>
        <a href="index.html">
            <img src="rajagiri.png" alt="Rajagiri Logo" class="logo hvr-grow" />
        </a>
        <div class="button-container">
            <button onclick="window.location.href='teach_pending.html'">Pending Events</button>
            <button onclick="window.location.href='teach_events.html'">All Events</button>
            <button id="logout" onclick="logout()">Logout</button>
        </div>
    </header>

    <h1>Add Event</h1>

    <form id="eventForm" action="/api/add-event">
        <label for="name">Event Name:</label>
        <input type="text" id="name" name="name" required><br><br>

        <label for="start_date">Start Date:</label>
        <input type="date" id="start_date" name="start_date" required><br><br>

        <label for="end_date">End Date:</label>
        <input type="date" id="end_date" name="end_date" required><br><br>

        <label for="start_time">Start Time:</label>
        <input type="time" id="start_time" name="start_time" required><br><br>

        <label for="end_time">End Time:</label>
        <input type="time" id="end_time" name="end_time" required><br><br>

        <label for="points">Activity Points:</label>
        <input type="number" id="points" name="points" required><br><br>

        <label for="fee">Entry Fee:</label>
        <input type="number" id="fee" name="fee" required><br><br>

        <label for="venue">Venue:</label>
        <input type="text" id="venue" name="venue" required><br><br>

        <label for="link">Event Link:</label>
        <input type="url" id="link" name="link" required><br><br>

        <button type="submit">Add Event</button>
    </form>

    <footer>
        <div class="footer-text">
            <p>&copy; 2024 Rajagiri Event Management System. All rights reserved.</p>
        </div>
    </footer>

    <script>
        // Function to handle form submission
        document.getElementById('eventForm').addEventListener('submit', function (event) {
    event.preventDefault(); // Prevent default form submission

    const formData = new FormData(this);
    
    // Log form data for debugging
    for (let [key, value] of formData.entries()) {
        console.log(`${key}: ${value}`);
    }

    fetch('/api/add-event', {
        method: 'POST',
        body: formData
    })
    .then(response => {
        if (response.ok) {
            alert('Event added successfully!');
            window.location.href = 'stud_events.html'; // Redirect to available events page
        } else {
            alert('Error adding event!');
        }
    })
    .catch(error => {
        console.error('Error adding event:', error);
        alert('An error occurred while adding the event.');
    });
});


        // Function to handle logout
        function logout() {
            fetch('/api/logout', {
                method: 'POST',
            })
            .then(response => {
                if (response.ok) {
                    alert('Logged out successfully.');
                    window.location.href = 'index.html';
                } else {
                    alert('Error logging out!');
                }
            })
            .catch(error => {
                console.error('Error during logout:', error);
                alert('An error occurred while logging out.');
            });
        }
        function validateForm() {
    const name = document.getElementById('name').value;
    const startDate = document.getElementById('start_date').value;
    const endDate = document.getElementById('end_date').value;
    const startTime = document.getElementById('start_time').value;
    const endTime = document.getElementById('end_time').value;
    const points = document.getElementById('points').value;
    const fee = document.getElementById('fee').value;
    const venue = document.getElementById('venue').value;
    const link = document.getElementById('link').value;

    // Check if points or fee are less than 0
    if (parseInt(points) < 0) {
        alert('Activity points cannot be less than 0.');
        return false;
    }

    if (parseInt(fee) < 0) {
        alert('Entry fee cannot be less than 0.');
        return false;
    }

    // Additional validations like required fields can be added here
    if (!name || !startDate || !endDate || !startTime || !endTime || !venue || !link) {
        alert('Please fill in all fields.');
        return false;
    }

    return true; // If everything is valid, return true
}

// Add event listener for form submission
document.getElementById('eventForm').addEventListener('submit', function(event) {
    if (!validateForm()) {
        event.preventDefault(); // Prevent form submission if validation fails
    }
});
    </script>
</body>
</html>
