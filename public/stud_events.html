<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="UTF-8" />
	<meta name="viewport" content="width=device-width, initial-scale=1.0" />
	<title>REMS | Student Events</title>
	<link rel="stylesheet" href="stud_events.css" />
	<link rel="icon" href="rajagiri.png" type="image/png">
</head>
<body>
	<!-- Logo to return to the homepage -->
	<div class="logo">
		<a href="index.html"><img src="rajagiri.png" alt="Rajagiri Logo" /></a>
	</div>
	
	<h1>Available Events</h1>
	
	<div id="event-list" class="scrollable-list">
		<!-- Events will be dynamically inserted here -->
	</div>

	<script>
		document.addEventListener("DOMContentLoaded", function() {
			// Check if the user is authenticated
			fetch('/api/check-auth')
				.then(response => {
					if (response.status === 401) {
						// Redirect to index.html if not authenticated
						window.location.href = 'index.html';
					} else if (response.ok) {
						// Fetch events data if authenticated
						fetch('/api/events')
							.then(response => response.json())
							.then(events => {
								const eventList = document.getElementById('event-list');
								events.forEach(event => {
									const eventItem = document.createElement('div');
									eventItem.classList.add('event-item');

									eventItem.innerHTML = `
										<h2>${event.name}</h2>
										<p><strong>Start Date:</strong> ${event.start_date}</p>
										<p><strong>End Date:</strong> ${event.end_date}</p>
										<p><strong>Start Time:</strong> ${event.start_time}</p>
										<p><strong>End Time:</strong> ${event.end_time}</p>
										<p><strong>Points:</strong> ${event.points}</p>
										<p><strong>Fee:</strong> ${event.fee}</p>
										<p><strong>Venue:</strong> ${event.venue}</p>
										<a href="${event.link}" target="_blank">More Info</a>
									`;
									eventList.appendChild(eventItem);
								});
							})
							.catch(error => console.error('Error fetching events:', error));
					}
				})
				.catch(error => {
					console.error('Error checking authentication:', error);
					window.location.href = 'index.html';
				});
		});
	</script>
</body>
</html>
